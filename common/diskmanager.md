{{indexmenu_n>2}}

## 磁盘管理

磁盘管理方式包括自动清理日志和无操作，清理日志即为当磁盘到达设定的阈值时开始清理日志文件，避免由于磁盘写满导致Kafka服务不可用。

### 清理日志

当集群中某个节点的磁盘使用率达到您设定的阈值时，UKafka会开始自动清理日志。

清理流程为，首先将该节点上所有topic日志文件按照时间排序，然后通过调整目标topic日志保存时间来删除旧日志，最终使磁盘使用率到达阈值之下，UKafka清理完日志后会恢复各topic的日志保存时间到您设定的值或默认值。

为了您的业务安全，UKafka至少会保留各topic最近1天的日志。

\=== 开启清理日志 ===

集群创建时和集群运行中都可以开启该功能。

\- 创建集群时

磁盘管理方式默认为“清理日志”。不建议您选择“无操作”，这样会导致磁盘写满之后kafka服务不可用。

![](/images/common/disk_manager_create.png)

磁盘使用率阈值默认为80%，可选范围为70%\~90%。
![](/images/common/disk_threshold_create.png)

\- 集群运行中

选“磁盘管理”，然后可以修改磁盘管理方式和磁盘使用率阈值，调整后立即生效。

![](/images/common/disk_manager_running.png)

![](/images/common/disk_mger_running_pop.png)

### 无操作

若选择不由UKafka管理磁盘，十分建议您在监控中开启磁盘使用率告警，在磁盘使用率达到80%时，可在控制台清理各topic的旧日志。

清理方法为，选择“topic管理”中的“更新配置”，在弹出窗口中调小“日志保存时间”。
